---
title: "Geographical Location and Internet Quality of Life"
subtitle: "IDS 2022 - Workshop Group 31/1 Project"
author: "Team Members - Zhihong Chen, Ryan Hall, Chenyi He, Eric Rogers, Eddie Washbrook"
institute: "University of Edinburgh"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      
---



```{r load-packages, include = FALSE}
# Add any additional packages you need to this chunk
library(tidyverse)
library(tidymodels)
library(palmerpenguins)
library(knitr)
library(xaringanthemer)
```

```{r setup, include=FALSE}
# For better figure resolution
knitr::opts_chunk$set(fig.retina = 3, dpi = 300, fig.width = 6, fig.asp = 0.618, out.width = "80%")
```

```{r load-data, include=FALSE}
# Load your data here

```

```{r include=FALSE}
style_xaringan(
  title_slide_background_image = "img/wallpaper2.jpg"
)
```

# Recap

 - Do geographical location and characteristics have an effect on internet quality of life in the UK? 
 - Feb / Aug 2019 - data.gov.uk - Ofcom
 - GDHI data per region - ONS

---

# Findings

 - We saw trends in the data that exist between location and Internet QOL
 - Not enough data to be able to back up this link
 - Unable to establish a clear/strong connection given the data we had

---

# Choropleth Maps

Ryan

---

# Linear Modelling

How does GDHI per head affect IQOL:
```{r income-24h_download, echo = FALSE}
# Predicting 24 hour average download speed from GDHI per head
all_24h_ads_gdhi_fit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(x24_hr_average_download_speed ~ gdhi_per_head, data = all_gdhi_join) %>%
  tidy()
all_24h_ads_gdhi_fit
```
```{r income-24h_packetloss, echo = FALSE}
# Predicting 24 hour packet loss from GDHI per head
all_24h_pl_gdhi_fit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(x24_hour_packet_loss ~ gdhi_per_head, data = all_gdhi_join) %>%
  tidy()
all_24h_pl_gdhi_fit
```
```{r income-24h_latency, echo = FALSE}
# Predicting 24 hour latency from GDHI per head
all_24h_ltcy_gdhi_fit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(x24_hour_latency ~ gdhi_per_head, data = all_gdhi_join) %>%
  tidy()
all_24h_ltcy_gdhi_fit
```
```{r income-24h_netflixstartupdelay, echo = FALSE}
# Predicting 24 hour netflix startup delay from GDHI per head
all_24h_nsud_gdhi_fit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(x24_hour_netflix_start_up_delay ~ gdhi_per_head, data = all_gdhi_join) %>%
  tidy()
all_24h_nsud_gdhi_fit
```
How does living in urban or rural area affect IQOL:
```{r urbanrural-24h_download, echo = FALSE}
all_24h_ads_ur_fit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(x24_hr_average_download_speed ~ urban_rural, data = all_gdhi_join) %>%
  tidy()
all_24h_ads_ur_fit
```
```{r ur-24h_packetloss, echo = FALSE}
# Predicting 24 hour packet loss from GDHI per head
all_24h_pl_gdhi_fit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(x24_hour_packet_loss ~ urban_rural, data = all_gdhi_join) %>%
  tidy()
all_24h_pl_gdhi_fit
```
```{r ur-24h_latency, echo = FALSE}
# Predicting 24 hour latency from GDHI per head
all_24h_pl_gdhi_fit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(x24_hour_latency ~ urban_rural, data = all_gdhi_join) %>%
  tidy()
all_24h_pl_gdhi_fit
```
```{r ur-24h_netflixstartupdelay, echo = FALSE}
# Predicting 24 hour netflix startup delay from GDHI per head
all_24h_nsud_gdhi_fit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(x24_hour_netflix_start_up_delay ~ urban_rural, data = all_gdhi_join) %>%
  tidy()
all_24h_nsud_gdhi_fit
```
A tiny change from Feburary to August:
```{r urbanrural-24h_download-feb, echo = FALSE}
feb_24h_ads_ur_fit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(x24_hr_average_download_speed ~ urban_rural, data = feb_gdhi_join) %>%
  tidy()
feb_24h_ads_ur_fit
```
```{r urbanrural-24h_download-aug, echo = FALSE}
aug_24h_ads_ur_fit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(x24_hr_average_download_speed ~ urban_rural, data = aug_gdhi_join) %>%
  tidy()
aug_24h_ads_ur_fit
```
How do GDHI per head and Urban/rural area affect 24 hours average download speed:
```{r setseed-split, echo=FALSE}
set.seed(1234)
all_gdhi_join_split <- initial_split(all_gdhi_join)
all_gdhi_join_train <- training(all_gdhi_join_split)
all_gdhi_join_test <- testing(all_gdhi_join_split)
```
```{r variables effect 24h-download, echo=FALSE }
all_gdhi_join_train_rec <- recipe(x24_hr_average_download_speed ~ urban_rural + gdhi_per_head, data = all_gdhi_join_train) %>%
 step_dummy(all_nominal(), -all_outcomes()) 

all_gdhi_join_train_mod <- linear_reg() %>%
 set_engine('lm')

all_gdhi_join_train_wflow <- workflow() %>% 
 add_model(all_gdhi_join_train_mod) %>% 
 add_recipe(all_gdhi_join_train_rec)

all_gdhi_join_train_fit <- all_gdhi_join_train_wflow %>% 
 fit(data = all_gdhi_join_train)

all_gdhi_join_train_fit
```

---

# Model Accuracy - Residual Plots

Zhihong

---

# Model Training and Prediction

 - Some predicted values were similar to the observed

 - However many were significantly different.

 - ADS = 39.15 + Urban/Rural(42.26) + GDHI(1.67*10^-4)

 - Equation of model heavily weighted to significance of urban/rural.

 - This suggests some other variable may be involved or more data is required to see significance of GDHI

---

class: inverse, center, middle

## Thank You

---

